<!DOCTYPE html>
<html>



<head>

    <!-- Microsoft Internet Explorer documentMode compatMode setting IE Modus --> 
    <script type="text/javascript">
    var IE = null;
    if (window.navigator.appName == "Microsoft Internet Explorer") {
      if (document.documentMode) {

        IE = document.documentMode; 
    } else {

        IE = 5; 
        if (document.compatMode) {
          if (document.compatMode == "CSS1Compat")
              IE = 11; 
      }
  }
}
</script>

<meta charset="utf-8">
<!-- X-UA --> 
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<!--<link rel="author" title="stillwater" href="https://plus.google.com/u/0/101869488504092117335/posts"/>
-->

<!--<meta name="google-site-verification" content="F5lkHug5Hdw4XRPcwJuQsK01auhET-yWy1o5SrCM-Sw" />
-->
<meta name="google" content="notranslate" />
<!-- Viewport --> 
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- index ROBOTS follow --> 
<meta name="robots"    content="index, follow" />
<!-- Site Desciption --> 
<meta name="description" content="Hello, My Name is stillwater, I'm a software Engineer and Web Developer from China. ">
<!-- Site Desciption --> 
<meta name="keywords" content="stillwater,victorylee, Web Developer, Front End Engineer">
<!-- Favicon --> 
<link rel="shortcut icon" href="/img/favicon-7326478236.png" type="image/x-icon" />
<!-- Blog Title -->
<title>stillwaterli - A software Engineer and Web Developer from China.  </title>

    <!--     <title>AWK命令 - stillwater</title>
--> 
<!-- Property Metas --> 
<meta property="og:image" content="/img/93TyTG3x.png"/>
<meta property="og:title" content="Hello, My Name is stillwater, I'm a software Engineer and Web Developer from China. "/>
<meta property="og:site_name" content="Hello, My Name is stillwater, I'm a software Engineer and Web Developer from China. "/>
<!-- Canonical -->
<link rel="canonical" href="http://localhost:4000/2016/10/12/AWK%E5%91%BD%E4%BB%A4.html">
<!-- StyleSheet -->
<link rel="stylesheet" href="/css/pygments.css">
<link rel="stylesheet" href="/css/duoshuo.css">
<link rel="stylesheet" href="/css/bootstrap.min.css">

<link rel="stylesheet" href="/css/spaceg.stylesheets.css">
<!-- Fonts -->
<link href='https://fonts.googleapis.com/css?family=Merriweather:400,300,300italic,400italic,700,700italic,900,900italic' rel='stylesheet' type='text/css'>
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
<link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=Playfair+Display:400,700,900,400italic,700italic,900italic' rel='stylesheet' type='text/css'>
<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->
         <!-- <link href="https://gist-assets.github.com/assets/embed-b67021dc07195830cc157f7720b938fb.css" rel="stylesheet" type="text/css">-->

        <!-- Loading front stylesheet here --> 
        <style>

        .post-heading h1,.post-heading h2,.post-heading span{
            color:black !important;
        }
        .intro{
            margin: 50px;
            text-align: center;
        }
        .intro .post-heading h1{font-size:35px;}
        .intro .post-heading .subheading,.intro-header .post-heading .meta{line-height:1.1;display:block}
        .intro .post-heading .subheading{font-family:'Open Sans','Helvetica Neue',Helvetica,Arial,sans-serif;font-size:24px;margin:10px 0 30px;font-weight:400;color:white;}
        .intro .post-heading .meta{font-family:'Playfair Display', Times, serif;font-style:italic;font-weight:300;font-size:20px;color:white;}
        .intro .post-heading .meta a{color:#fff}
        @media only screen and (min-width: 768px){.intro .post-heading h1{font-size:55px}
        .intro .post-heading .subheading{font-size:30px;color:white;}}
        #preloader {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #fff;
            /* change if the mask should have another color then white */
            z-index: 99;
            /* makes sure it stays on top */
        }

        #status {
            width: 200px;
            height: 200px;
            position: absolute;
            left: 50%;
            /* centers the loading animation horizontally one the screen */
            top: 50%;
            /* centers the loading animation vertically one the screen */
            background-image: url("img/preloader.gif");
            /* path to your loading animation */
            background-repeat: no-repeat;
            background-position: center;
            margin: -100px 0 0 -100px;
            /* is width and height divided by two */
        }

        ul, ol {
            margin-top: 0;
            margin-bottom: 10px;
            list-style: none;
        }

        .navbar-inverse {
            background-color: #FFF;
            border-color: #FFFFFF;
        }
        </style>
        <link rel="stylesheet" href="/css/prettify.css">
        <style>header.intro-header {
            background: #6f5499;
            background: no-repeat center center;
            background-attachment: scroll;
            -webkit-background-size: cover;
            -moz-background-size: cover;
            background-size: cover;
            -o-background-size: cover;
            }/* Preloader */#preloader {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background-color: #fff;
                /* change if the mask should have another color then white */
                z-index: 99;
                /* makes sure it stays on top */
            }

            #status {
                width: 200px;
                height: 200px;
                position: absolute;
                left: 50%;
                /* centers the loading animation horizontally one the screen */
                top: 50%;
                /* centers the loading animation vertically one the screen */
                background-image:;
                /* path to your loading animation */
                background-repeat: no-repeat;
                background-position: center;
                margin: -100px 0 0 -100px;
                /* is width and height divided by two */
            }

            li {
                list-style: none;
            }
            li 
            {list-style: none;}
            body.modal-open 
            {overflow: hidden;padding-right: 0px;
            }
            </style>
            <!-- end Loading front stylesheet here --> 
        </head>



<body>

	
<div id="preloader">
    <div id="status">

    </div>

</div>  

    
<!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
                <!--
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapses-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button> -->
            <a class="navbar-brand" href="/" id="blog-title-left-top">ME</a>
        </div>   
        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
              <li class="dropdown">
                <a href="#portfolioModal2" data-toggle="modal"><i class="fa fa-random" id="icon-top"></i></a>
                <ul class="dropdown-menu"></ul>
            </li>
            <li><a href="http://weibo.com/u/3948730723" target="_blank"><i class="fa fa-weibo" id="icon-top"></i></a></li>

            <li><a href="/about" target="_blank">About</a></li>
            <li><a href="/archive/">Archive</a></li>
            <li><a href="https://www.github.com/superstar4" id="roundbutton" target="_blank"><i class="fa fa-github"></i>stillwater</a></li>
        </ul>
    </div>
    <!-- /.navbar-collapse -->
</div>
<!-- /.container -->
</nav>
<!-- Portfolio Modals -->
<div class="portfolio-modal modal fade" id="portfolioModal1" tabindex="-1" role="dialog" aria-hidden="true" style="padding-right:0px; overflow: hidden;">
    <div class="modal-content">
        <div class="close-modal" data-dismiss="modal">
            <div class="lr">
                <div class="rl">
                </div>
            </div>
        </div>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2">
                    <div class="modal-body">
                        <h1 class="font-style-inline-small-h1">stillwater</h1>
                        <hr class="star-primary">
                        <img src="/img/photo.jpg" class="img-responsive img-centered" alt="Lucas Gatsas lucas gatsas" title="lucas gatsas Lucas Gatsas">
                        <p class="font-style-inline-small">
                            Hello, My Name is stillwater, I'm a software Engineer and Web Developer from China.  <br>
                            <a href="https://www.github.com/superstar4" target="_blank">    <i class="fa fa-github" id="spaceg-social-modal"></i> </a> 
                            <a class="follow" href="https://plus.google.com/u/0/101869488504092117335/posts" target="_blank"><i class="fa fa-google-plus"></i></a>

                            <a class="follow" href="" target="_blank"><i class="fa fa-facebook"></i></a>

                            <a class="follow" href="http://weibo.com/u/3948730723" target="_blank"><i class="fa fa-weibo"></i></a> 
                        </p>
                        <button type="button" class="btn btn-default" data-dismiss="modal"><i class="fa fa-times"></i> Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Menu Modals Add New Sa.21.Feb.2015 03:22:25 -->
<div class="portfolio-modal modal fade" id="portfolioModal2" tabindex="-1" role="dialog" aria-hidden="true" style="padding-right:0px; overflow: hidden;">
    <div class="modal-content">
        <div class="close-modal" data-dismiss="modal">
            <div class="lr">
                <div class="rl">
                </div>
            </div>
        </div>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2">
                    <div class="modal-body">
                        <h1 class="font-style-inline-small-h1">stillwater</h1>
                        <hr class="star-primary">
                        <!--     <img src="https://pbs.twimg.com/profile_images/598639420363923456/zLAW5YPs_400x400.jpg" class="img-responsive img-centered" alt=""> -->
                        <p class="font-style-inline-small">
                           <a href="https://www.github.com/superstar4" target="_blank">    <i class="fa fa-github" id="spaceg-social-modal"></i> </a> 
                            <a class="follow" href="https://plus.google.com/u/0/101869488504092117335/posts" target="_blank"><i class="fa fa-google-plus"></i></a>

                            <a class="follow" href="" target="_blank"><i class="fa fa-facebook"></i></a>

                            <a class="follow" href="http://weibo.com/u/3948730723" target="_blank"><i class="fa fa-weibo"></i></a> 
                        
                             <br>
                            <li><a href="/">Home</a></li>
                            <li><a href="/about">About Me</a></li>
                            <li><a href="/archive/">Archive</a></li>
                        </p>

                        <button type="button" class="btn btn-default" data-dismiss="modal"><i class="fa fa-times"></i> Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



    <!-- Post Header -->
 
    <header class="intro">

    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>AWK命令</h1>
                    
                    <span class="meta">Posted by stillwater  </span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

				<p>简介
awk是一个强大的文本分析工具，相对于grep的查找，sed的编辑，awk在其对数据分析并生成报告时，显得尤为强大。简单来说awk就是把文件逐行的读入，以空格为默认分隔符将每行切片，切开的部分再进行各种分析处理。</p>

<!-- more -->
<p>awk有3个不同版本: awk、nawk和gawk，未作特别说明，一般指gawk，gawk 是 AWK 的 GNU 版本。</p>

<p>awk其名称得自于它的创始人 Alfred Aho 、Peter Weinberger 和 Brian Kernighan 姓氏的首个字母。实际上 AWK 的确拥有自己的语言： AWK 程序设计语言 ， 三位创建者已将它正式定义为“样式扫描和处理语言”。它允许您创建简短的程序，这些程序读取输入文件、为数据排序、处理数据、对输入执行计算以及生成报表，还有无数其他的功能。</p>

<p>使用方法</p>

<p>awk ‘{pattern + action}’ {filenames}
尽管操作可能会很复杂，但语法总是这样，其中 pattern 表示 AWK 在数据中查找的内容，而 action 是在找到匹配内容时所执行的一系列命令。花括号（{}）不需要在程序中始终出现，但它们用于根据特定的模式对一系列指令进行分组。 pattern就是要表示的正则表达式，用斜杠括起来。</p>

<p>awk语言的最基本功能是在文件或者字符串中基于指定规则浏览和抽取信息，awk抽取信息后，才能进行其他文本操作。完整的awk脚本通常用来格式化文本文件中的信息。</p>

<p>通常，awk是以文件的一行为处理单位的。awk每接收文件的一行，然后执行相应的命令，来处理文本。</p>

<p>调用awk</p>

<p>有三种方式调用awk</p>

<ol>
  <li>
    <p>命令行方式</p>

    <p>awk [-F  field-separator]  ‘commands’  input-file(s)其中，commands 是真正awk命令，[-F域分隔符]是可选的。 input-file(s) 是待处理的文件。在awk中，文件的每一行中，由域分隔符分开的每一项称为一个域。通常，在不指名-F域分隔符的情况下，默认的域分隔符是空格。</p>
  </li>
  <li>
    <p>shell脚本方式</p>

    <p>将所有的awk命令插入一个文件，并使awk程序可执行，然后awk命令解释器作为脚本的首行，一遍通过键入脚本名称来调用。
相当于shell脚本首行的：#!/bin/sh
可以换成：#!/bin/awk3.将所有的awk命令插入一个单独文件，然后调用：awk -f awk-script-file input-file(s). 其中，-f选项加载awk-script-file中的awk脚本，input-file(s)跟上面的是一样的。</p>
  </li>
  <li>
    <p>所有的awk命令插入一个单独文件，然后调用：
 awk -f awk-script-file input-file(s)
 其中，-f选项加载awk-script-file中的awk脚本，input-file(s)跟上面的是一样的。</p>
  </li>
</ol>

<p>本章重点介绍命令行方式。</p>

<p>入门实例
假设last -n 5的输出如下</p>

<div class="highlighter-rouge"><pre class="highlight"><code>[root@www ~]# last -n 5 &lt;==仅取出前五行
root     pts/1   192.168.1.100  Tue Feb 10 11:21   still logged in
root     pts/1   192.168.1.100  Tue Feb 10 00:46 - 02:28  (01:41)
root     pts/1   192.168.1.100  Mon Feb  9 11:41 - 18:30  (06:48)
dmtsai   pts/1   192.168.1.100  Mon Feb  9 11:41 - 11:41  (00:00)
root     tty1                   Fri Sep  5 14:09 - 14:10  (00:01)
</code></pre>
</div>

<p>如果只是显示最近登录的5个帐号</p>

<div class="highlighter-rouge"><pre class="highlight"><code>last -n 5 | awk  '{print $1}'
root
root
root
dmtsai
root
</code></pre>
</div>

<p>awk工作流程是这样的：读入有’\n’换行符分割的一条记录，然后将记录按指定的域分隔符划分域，填充域，$0则表示所有域,$1表示第一个域,$n表示第n个域。默认域分隔符是”空白键” 或 “[tab]键”,所以$1表示登录用户，$3表示登录用户ip,以此类推。</p>

<p>如果只是显示/etc/passwd的账户</p>
<div class="highlighter-rouge"><pre class="highlight"><code>cat /etc/passwd |awk  -F ':'  '{print $1}'  
root
daemon
bin
sys
</code></pre>
</div>
<p>这种是awk+action的示例，每行都会执行action{print $1}。</p>

<p>-F指定域分隔符为’:’。</p>

<p>如果只是显示/etc/passwd的账户和账户对应的shell,而账户与shell之间以tab键分割</p>

<div class="highlighter-rouge"><pre class="highlight"><code>cat /etc/passwd |awk  -F ':'  '{print $1"\t"$7}'
root    /bin/bash
daemon  /bin/sh
bin     /bin/sh
sys     /bin/sh
</code></pre>
</div>

<p>如果只是显示/etc/passwd的账户和账户对应的shell,而账户与shell之间以逗号分割,而且在所有行添加列名name,shell,在最后一行添加”blue,/bin/nosh”。</p>

<div class="highlighter-rouge"><pre class="highlight"><code>cat /etc/passwd |awk  -F ':'  'BEGIN {print "name,shell"}  {print $1","$7} END {print "blue,/bin/nosh"}'
name,shell
root,/bin/bash
daemon,/bin/sh
bin,/bin/sh
sys,/bin/sh
....
blue,/bin/nosh
</code></pre>
</div>

<p>awk工作流程是这样的：先执行BEGING，然后读取文件，读入有/n换行符分割的一条记录，然后将记录按指定的域分隔符划分域，填充域，$0则表示所有域,$1表示第一个域,$n表示第n个域,随后开始执行模式所对应的动作action。接着开始读入第二条记录······直到所有的记录都读完，最后执行END操作。</p>

<p>搜索/etc/passwd有root关键字的所有行</p>

<div class="highlighter-rouge"><pre class="highlight"><code>awk -F: '/root/' /etc/passwd
root:x:0:0:root:/root:/bin/bash
</code></pre>
</div>
<p>这种是pattern的使用示例，匹配了pattern(这里是root)的行才会执行action(没有指定action，默认输出每行的内容)。</p>

<p>搜索支持正则，例如找root开头的: awk -F: ‘/^root/’ /etc/passwd</p>

<p>搜索/etc/passwd有root关键字的所有行，并显示对应的shell</p>

<div class="highlighter-rouge"><pre class="highlight"><code> awk -F: '/root/{print $7}' /etc/passwd             
/bin/bash
</code></pre>
</div>
<p>这里指定了action{print $7}</p>

<p>awk内置变量
awk有许多内置变量用来设置环境信息，这些变量可以被改变，下面给出了最常用的一些变量。</p>

<p>复制代码
ARGC               命令行参数个数
ARGV               命令行参数排列
ENVIRON            支持队列中系统环境变量的使用
FILENAME           awk浏览的文件名
FNR                浏览文件的记录数
FS                 设置输入域分隔符，等价于命令行 -F选项
NF                 浏览记录的域的个数
NR                 已读的记录数
OFS                输出域分隔符
ORS                输出记录分隔符
RS                 控制记录分隔符
复制代码
 此外,$0变量是指整条记录。$1表示当前行的第一个域,$2表示当前行的第二个域,……以此类推。</p>

<p>统计/etc/passwd:文件名，每行的行号，每行的列数，对应的完整行内容:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>awk  -F ':'  '{print "filename:" FILENAME ",linenumber:" NR ",columns:" NF ",linecontent:"$0}' /etc/passwd
filename:/etc/passwd,linenumber:1,columns:7,linecontent:root:x:0:0:root:/root:/bin/bash
filename:/etc/passwd,linenumber:2,columns:7,linecontent:daemon:x:1:1:daemon:/usr/sbin:/bin/sh
filename:/etc/passwd,linenumber:3,columns:7,linecontent:bin:x:2:2:bin:/bin:/bin/sh
filename:/etc/passwd,linenumber:4,columns:7,linecontent:sys:x:3:3:sys:/dev:/bin/sh
</code></pre>
</div>

<p>使用printf替代print,可以让代码更加简洁，易读</p>

<div class="highlighter-rouge"><pre class="highlight"><code> awk  -F ':'  '{printf("filename:%10s,linenumber:%s,columns:%s,linecontent:%s\n",FILENAME,NR,NF,$0)}' /etc/passwd
</code></pre>
</div>

<p>print和printf
awk中同时提供了print和printf两种打印输出的函数。</p>

<p>其中print函数的参数可以是变量、数值或者字符串。字符串必须用双引号引用，参数用逗号分隔。如果没有逗号，参数就串联在一起而无法区分。这里，逗号的作用与输出文件的分隔符的作用是一样的，只是后者是空格而已。</p>

<p>printf函数，其用法和c语言中printf基本相似,可以格式化字符串,输出复杂时，printf更加好用，代码更易懂。</p>

<p>awk编程
 变量和赋值</p>

<p>除了awk的内置变量，awk还可以自定义变量。</p>

<p>下面统计/etc/passwd的账户人数</p>

<div class="highlighter-rouge"><pre class="highlight"><code>awk '{count++;print $0;} END{print "user count is ", count}' /etc/passwd
root:x:0:0:root:/root:/bin/bash
......
user count is  40
</code></pre>
</div>
<p>count是自定义变量。之前的action{}里都是只有一个print,其实print只是一个语句，而action{}可以有多个语句，以;号隔开。</p>

<p>这里没有初始化count，虽然默认是0，但是妥当的做法还是初始化为0:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>awk 'BEGIN {count=0;print "[start]user count is ", count} {count=count+1;print $0;} END{print "[end]user count is ", count}' /etc/passwd
[start]user count is  0
root:x:0:0:root:/root:/bin/bash
...
[end]user count is  40
</code></pre>
</div>

<p>统计某个文件夹下的文件占用的字节数</p>

<div class="highlighter-rouge"><pre class="highlight"><code>ls -l |awk 'BEGIN {size=0;} {size=size+$5;} END{print "[end]size is ", size}'
[end]size is  8657198
</code></pre>
</div>

<p>如果以M为单位显示:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>ls -l |awk 'BEGIN {size=0;} {size=size+$5;} END{print "[end]size is ", size/1024/1024,"M"}' 
[end]size is  8.25889 M
</code></pre>
</div>
<p>注意，统计不包括文件夹的子目录。</p>

<p>条件语句</p>

<p>awk中的条件语句是从C语言中借鉴来的，见如下声明方式：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>if (expression) {
    statement;
    statement;
    ... ...
}

if (expression) {
    statement;
} else {
    statement2;
}

if (expression) {
    statement1;
} else if (expression1) {
    statement2;
} else {
    statement3;
}
</code></pre>
</div>

<p>统计某个文件夹下的文件占用的字节数,过滤4096大小的文件(一般都是文件夹):</p>

<div class="highlighter-rouge"><pre class="highlight"><code>ls -l |awk 'BEGIN {size=0;print "[start]size is ", size} {if($5!=4096){size=size+$5;}} END{print "[end]size is ", size/1024/1024,"M"}' 
[end]size is  8.22339 M
</code></pre>
</div>

<p>循环语句</p>

<p>awk中的循环语句同样借鉴于C语言，支持while、do/while、for、break、continue，这些关键字的语义和C语言中的语义完全相同。</p>

<p>数组</p>

<p>因为awk中数组的下标可以是数字和字母，数组的下标通常被称为关键字(key)。值和关键字都存储在内部的一张针对key/value应用hash的表格里。由于hash不是顺序存储，因此在显示数组内容时会发现，它们并不是按照你预料的顺序显示出来的。数组和变量一样，都是在使用时自动创建的，awk也同样会自动判断其存储的是数字还是字符串。一般而言，awk中的数组用来从记录中收集信息，可以用于计算总和、统计单词以及跟踪模板被匹配的次数等等。</p>

<p>显示/etc/passwd的账户</p>

<div class="highlighter-rouge"><pre class="highlight"><code>awk -F ':' 'BEGIN {count=0;} {name[count] = $1;count++;}; END{for (i = 0; i &lt; NR; i++) print i, name[i]}' /etc/passwd0 root
1 daemon
2 bin
3 sys
4 sync5 games
......
</code></pre>
</div>

<p>这里使用for循环遍历数组</p>

<p>awk编程的内容极多，这里只罗列简单常用的用法，更多请参考 http://www.gnu.org/software/gawk/manual/gawk.html</p>

<p>awk统计命令
1、求和
代码示例:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>cat data|awk '{sum+=$1} END {print "Sum = ", sum}'
</code></pre>
</div>
<p>2、求平均</p>

<p>代码示例:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>cat data|awk '{sum+=$1} END {print "Average = ", sum/NR}'
</code></pre>
</div>
<p>3、求最大值</p>

<p>代码示例:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>cat data|awk 'BEGIN {max = 0} {if ($1&gt;max) max=$1 fi} END {print "Max=", max}'
</code></pre>
</div>
<p>4、求最小值（min的初始值设置一个超大数即可）
代码示例:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>awk 'BEGIN {min = 1999999} {if ($1&lt;min) min=$1 fi} END {print "Min=", min}'
</code></pre>
</div>

<h2 id="参考文章">参考文章：</h2>
<p><a href="http://www.cnblogs.com/ggjucheng/archive/2013/01/13/2858470.html">博客园</a></p>



                <hr>


<div id="ds-thread" class="ds-thread" data-url="/2016/10/12/AWK%E5%91%BD%E4%BB%A4.html" data-title="AWK命令" data-thread-key="AWK命令"></div>
<script type="text/javascript">
var duoshuoQuery = {short_name: "stillwater"};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = 'http://static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2015/10/18/%E4%B8%BA%E4%BB%80%E4%B9%88%E6%96%B0%E7%94%9F%E4%BB%A3%E6%9C%89%E4%B8%A4%E4%B8%AAsurvivor.html" data-toggle="tooltip" data-placement="top" title="2015-10-18-为什么新生代有两个survivor">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2016/11/10/Velocity%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB.html" data-toggle="tooltip" data-placement="top" title="Velocity源码阅读(转)">Next Post &rarr;</a>
                    </li>
                    
                </ul>

            </div>
        </div>
    </div>
</article>
<hr>



    <!-- Footer -->
<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center">
          <li>
            <a href="/feed.xml" data-datatype="json" data-type="GET" data-target="#frame" class="reload" id="clickme">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
          
          <li>
            <a href="" data-datatype="json" data-type="GET" data-target="#frame" class="reload" id="clickme" target="_blank">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-google-plus fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
          
          <li>
            <a href="https://github.com/superstar4" target="_blank">
              <span class="fa-stack fa-lg">

                <i class="fa fa-arrow-circle-o-down"></i>
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
          
          <li>
            <a href="http://weibo.com/u/3948730723" target="_blank">
              <span class="fa-stack fa-lg">

                <i class="fa fa-arrow-circle-o-down"></i>
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-weibo fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
          
        </ul>
        <p class="copyright text-muted">Copyright &copy; stillwater 2017 - 2016.
        </p>
      </div>
    </div>
  </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<script src="/js/spaceg.stylesheets.min.js"></script> 

<script src="/js/bootstrap.min.js "></script>




<script type="text/javascript">
  //<![CDATA[
    $(window).load(function() { // makes sure the whole site is loaded
      $('#status').fadeOut(); // will first fade out the loading animation
      $('#preloader').delay(150).fadeOut('fast'); // will fade out the white DIV that covers the website.
      $('body').delay(100).css({'overflow':'visible'});
    })
  //]]>
  </script> 

  <script>
  !function ($) {
    $(function(){
      window.prettyPrint && prettyPrint()
    })
  }(window.jQuery)
  </script>


  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-53988504-1', 'auto');
  ga('send', 'pageview');

  </script> 
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-63212709-1', 'auto');
  ga('send', 'pageview');

  </script>
<script>
$(function(){
    $('pre code').each(function(){
        var lines = $(this).text().split('\n').length-1;
        var $numbering = $('<ul/>').addClass('pre-numbering');
        $(this)
            .addClass('has-numbering')
            .parent()
            .append($numbering);
        for(i=1;i<=lines;i++){
            $numbering.append($('<li><span></span></li>').text(i));
        }
    });
});

</script>


    

</body>

</html>
